<openvidu-template
	#openviduApi="openviduApi"
	[wsUrl]="wsUrl"
	[sessionId]="sessionId"
	[participantId]="participantId"
	
	(onUpdateMainSpeaker)="handleOnUpdateMainSpeaker($event)"
	
	(onServerConnected)="handleOnServerConnected($event)"
	(onErrorServer)="handleOnErrorServer($event)"
	(onRoomConnected)="handleOnRoomConnected($event)"
	(onErrorRoom)="handleOnErrorRoom($event)"
	(onCameraAccessChange)="handleOnCameraAccessChange($event)"
	
	(onParticipantJoined)="handleOnParticipantJoined($event)"
	(onParticipantLeft)="handleOnParticipantLeft($event)"
	
	(onStreamAdded)="handleOnStreamAdded($event)"
	(onStreamRemoved)="handleOnStreamRemoved($event)"
	
	(onErrorMedia)="handleOnErrorMedia()"
	(onLeaveRoom)="handleOnLeaveRoom()"
	(onNewMessage)="handleOnNewMessage($event)"
	(onCustomNotification)="handleOnCustomNotification($event)">

	<div id="welcome" *ngIf="welcome">
		<header class="room-connecting-content-header">
			<h1>You're about to enter a video conversation room</h1>
		</header>

		<section class="body" *ngIf="connectionUiState == ConnectionState.NOT_CONNECTED">
			<div class="ai-spinner">
				<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" id="Layer_1" x="0px" y="0px" viewBox="0 0 38 38">
					<style type="text/css">
						.st0{fill:none;stroke:#D1D1D1;stroke-width:1;}
						.st1{fill:none;stroke:#FF2E63;stroke-width:1;transform-origin:18px 18px;}
						.st2{fill:none;stroke:#41CC8D;stroke-width:1;transform-origin:18px 18px;}
					</style>
					<g transform="translate(1 1)">
						<circle class="st0" cx="18" cy="18" r="18"></circle>
						<path class="st1" d="M36,18c0-9.9-8.1-18-18-18"></path>
						<path class="st2" d="M18,36c9.9,0,18-8.1,18-18"></path>
					</g>
				</svg>
			</div>
			<p class="text-state">Connecting...</p>
		</section>

		<section class="body" *ngIf="connectionUiState == ConnectionState.CONNECTED_TO_SERVER">
			<div class="ai-spinner">
				<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" id="Layer_1" x="0px" y="0px" viewBox="0 0 38 38">
					<style type="text/css">
						.st0{fill:none;stroke:#D1D1D1;stroke-width:1;}
						.st1{fill:none;stroke:#FF2E63;stroke-width:1;transform-origin:18px 18px;}
						.st2{fill:none;stroke:#41CC8D;stroke-width:1;transform-origin:18px 18px;}
					</style>
					<g transform="translate(1 1)">
						<circle class="st0" cx="18" cy="18" r="18"></circle>
						<path class="st1" d="M36,18c0-9.9-8.1-18-18-18"></path>
						<path class="st2" d="M18,36c9.9,0,18-8.1,18-18"></path>
					</g>
				</svg>
			</div>
			<p class="text-state">Joining room...</p>
		</section>
		
		<section class="body" *ngIf="connectionUiState == ConnectionState.CONNECTED_TO_ROOM || connectionUiState == ConnectionState.REQUESTING_CAMERA_ACCESS">
			<div class="ai-spinner">
				<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" id="Layer_1" x="0px" y="0px" viewBox="0 0 38 38">
					<style type="text/css">
						.st0{fill:none;stroke:#D1D1D1;stroke-width:1;}
						.st1{fill:none;stroke:#FF2E63;stroke-width:1;transform-origin:18px 18px;}
						.st2{fill:none;stroke:#41CC8D;stroke-width:1;transform-origin:18px 18px;}
					</style>
					<g transform="translate(1 1)">
						<circle class="st0" cx="18" cy="18" r="18"></circle>
						<path class="st1" d="M36,18c0-9.9-8.1-18-18-18"></path>
						<path class="st2" d="M18,36c9.9,0,18-8.1,18-18"></path>
					</g>
				</svg>
			</div>
			<p class="text-state">Loading camera...</p>
		</section>

		<section class="body" *ngIf="connectionUiState == ConnectionState.CAMERA_ACCESS_DENIED">
			<h2>The browser is blocking your camera and microphone.</h2>

			<figure>
				<img src="https://d1x2efl61akomv.cloudfront.net/images/blocked-camera-chrome.4c7620aa.png" height="38">
			</figure>

			<p class="text">To enter the the video conversation, click the camera icon next to the star in the right of the address bar.</p>
			<p class="text">From there, check <strong>Always allow to access camera and microphone.</strong></p>
		</section>
	</div>
	
	<div class="feedback-wrapper" *ngIf="!session && !welcome">
		<div class="thank-you-message">
			<p class="body">You have left the room</p>
		</div>
	</div>
	
	<div class="wrapper" *ngIf="session && !welcome">
		<!-- TOOLBAR -->
		<div class="toolbar">
			<md-toolbar [color]="primary">
				<span>{{sessionId}}</span>
				<span class="example-spacer"></span>
			</md-toolbar>
		</div>

		<md-sidenav-container>
			<!--<md-sidenav #sidenav mode="side" (open-start)="onSidenavOpenStart()">
				<ul>
					<li *ngFor="let chat of lastChats">
						{{chat.name}}
					</li>
				</ul>
			</md-sidenav>-->
			
			
			<!-- CHAT BUTTON -->
			<button md-fab class="chat-button" (click)="toggleChat()" *ngIf="!showChat">
				<md-icon>chat_bubble</md-icon>
			</button>
			
			<div class="md-sidenav-content">
				<!-- MAIN VIDEO -->
				<div #panelVideo class="panel-videos">
					<div class="stream-flex">
						<stream-appearin #streamAppearin *ngFor="let s of streams" class="stream" [stream]="s"
							[style.max-width]="streamMaxWidth"
							[style.max-height]="streamMaxHeight">
						</stream-appearin>
					</div>
					<div class="chat" *ngIf="showChat">
						<button class="close" (click)="toggleChat()">
							<md-icon>close</md-icon>
						</button>
						<ul>
							<li *ngFor="let message of chatMessages" [ngClass]="{'me': message.username == participantId}">
								<p>
									{{message.message}}
								</p>
							</li>
						</ul>
						<div class="message-input-container" (submit)="sendMessage(messageInput.value);" accept-charset="UTF-8">
							<form>
								<md-input-container color="primary" floatPlaceholder="never">
									<input mdInput #messageInput placeholder="Send a message">
								</md-input-container>
							</form>
						</div>
					</div>
				</div>

				<!-- BUTTONS & OTHERS VIDEOS -->
				<div class="bottom-bar">
					<div class="buttons">
						<button md-button class="toggle-mic" [ngClass]="{'disabled': !openviduApi.micEnabled}" (click)="toggleMic()">
							<md-icon>mic</md-icon>
							<md-icon class="disabled-icon">mic_off</md-icon>
							<div>Mute</div>
							<div class="disabled-text">Unmute</div>
						</button>
						<button md-fab class="close-session" (click)="leaveRoom()" title="Leave room">
							<md-icon>close</md-icon>
						</button>
						<button md-button class="toggle-camera" [ngClass]="{'disabled': !openviduApi.camEnabled}" (click)="toggleCamera()">
							<md-icon>videocam</md-icon>
							<md-icon class="disabled-icon">videocam_off</md-icon>
							<div>Video off</div>
							<div class="disabled-text">Video on</div>
						</button>
					</div>
				</div>
			</div>
		</md-sidenav-container>
	</div>
		
</openvidu-template>
